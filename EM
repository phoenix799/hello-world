package com;

import java.util.ArrayList;
import java.util.HashMap;

public class EmployeeManagement 
{
	private ArrayList<Employee> employeeList = new ArrayList<Employee>();
	
	public int addEmployee(Employee emp)
	{
		if(emp==null)
		{
			return 0;
		}
		if(employeeList!=null || employeeList.size()!=0)
		{
			for(Employee e : employeeList)
			{
				if(e.getEmployeeId()==emp.getEmployeeId())
				{
					return 0;
				}
			}
		}
				
		employeeList.add(emp);
		return 1;
		
		
	}
	
	public Employee getEmployee(int empid) throws EmployeeNotFoundException
	{
		if(employeeList!=null || employeeList.size()!=0)
		{
			for(Employee emp:employeeList)
			{
				if(emp.getEmployeeId()==empid)
					return emp;
			}
			
			EmployeeNotFoundException enfe = new EmployeeNotFoundException("EmployeeNotFoundException");
			throw enfe;
		}
		
		return null;
	}
	
	public int deleteEmployee(int empid)
	{
		if(employeeList!=null || employeeList.size()!=0)
		{
			for(Employee emp:employeeList)
			{
				if(emp.getEmployeeId()==empid)
				{
					employeeList.remove(emp);
					return employeeList.size();
				}
			}
			
			
		}
		
		
		return -1;
	}
	
	public Employee updateEmployee(int empid, String str) throws EmployeeAlreadyUpdatedException
	{
		if(employeeList!=null || employeeList.size()!=0)
		{
			for(Employee emp:employeeList)
			{
				if(emp.getEmployeeId()==empid)
				{
					if(emp.getEmployeeType().equalsIgnoreCase(str))
					{
						EmployeeAlreadyUpdatedException eaue = new EmployeeAlreadyUpdatedException("EmployeeAlreadyUpdatedException");
						throw eaue;
					}
					else
					{
						emp.setEmployeeType(str);
						return emp;
					}
				}
			}
			
			
		}
		
		return null;
	}
	
	public HashMap<String,Employee> getHighestPaidEmployeeByEmployeeType(ArrayList<String> als)
	{
		if(als==null || als.size() == 0)
		{
			return null;
		}
		
		double highContract=0.0, highPermanent=0.0;
		Employee empContract=null;
		Employee empPermanent=null;
		
		ArrayList<ContractEmployee> empContractList = new ArrayList<ContractEmployee>();
		ArrayList<PermanentEmployee> empPermanentList = new ArrayList<PermanentEmployee>();
		
		HashMap<String, Employee> hashMap = new HashMap<String, Employee>();
		
		for(String str: als)
		{
			for(Employee emp:employeeList)
			{
				if(emp.getEmployeeType().equalsIgnoreCase("Contract") && str.equalsIgnoreCase("Contract"))
				{
					empContractList.add((ContractEmployee) emp);
				}
				else
					if(emp.getEmployeeType().equalsIgnoreCase("Permanent") && str.equalsIgnoreCase("Permanent"))
					{
						empPermanentList.add((PermanentEmployee) emp);
					}
					
				
			}
		}
		
		for(String type: als)
		{
			if(type.equalsIgnoreCase("Contract"))
			{
				for(ContractEmployee ce :empContractList)
				{
					if(ce.calculateSalary()>highContract)
					{
						highContract=ce.calculateSalary();
						empContract=ce;
					}
				}
				
				hashMap.put(type,empContract);
			}
			else
				if(type.equalsIgnoreCase("Permanent"))
				{
					for(PermanentEmployee pe :empPermanentList)
					{
						if(pe.calculateSalary()>highPermanent)
						{
							highPermanent=pe.calculateSalary();
							empPermanent=pe;
						}
					}
					hashMap.put(type,empPermanent);
				}
		}
		
		
		
		
		
		return hashMap;
		
		
	}

}
